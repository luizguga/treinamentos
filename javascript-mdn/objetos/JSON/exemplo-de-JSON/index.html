<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our superheroes</title>
    <link rel="stylesheet" href="estilos/style.css">
</head>
<body>
    <header>

    </header>
    <section>

    </section>
    <script>
        const header = document.querySelector('header')
        const section = document.querySelector('section')

        let requestURL = 'https://mdn.github.io/learning-area/javascript/oojs/json/superheroes.json'
        let request = new XMLHttpRequest()
        request.open('GET', requestURL)
        request.responseType = 'json'
        request.send()

        request.onload = ()=>{
            let superHeroes = request.response
            populateHeader(superHeroes)
            showHeroes(superHeroes)
        }

        function populateHeader(jsonObj){
            let myH1 = document.createElement('h1')
            myH1.textContent = jsonObj['squadName']
            header.appendChild(myH1)

            let myPara = document.createElement('p')
            myPara.textContent = 'Hometown: ' + jsonObj['homeTown'] + ' // Formed: ' + jsonObj['formed']
            header.appendChild(myPara)
        }

        function showHeroes(jsonObj){
            let heroes = jsonObj['members']

            for(let i=0; i<heroes.length; i++){
                let myArticle = document.createElement('article')
                let myH2 = document.createElement('h2')
                let myPara1 = document.createElement('p')
                let myPara2 = document.createElement('p')
                let myPara3 = document.querySelector('p')
                let myList = document.createElement('ul')

                myH2.textContent = heroes[i].name
                myPara1.textContent = `Secret identity: ${heroes[i].secretIdentity}`
                myPara2.textContent = `Age: ${heroes[i].age}`
                myPara3.textContent = 'Superpowers:'

                let superPowers = heroes[i].powers
                for(let j=0; j<superPowers.length; j++){
                    let listItem = document.createElement('li')
                    listItem.textContent = superPowers[j]
                    myList.appendChild(listItem)
                }

                myArticle.appendChild(myH2)
                myArticle.appendChild(myPara1)
                myArticle.appendChild(myPara2)
                myArticle.appendChild(myPara3)
                myArticle.appendChild(myList)

                section.appendChild(myArticle)
            }
        }
        /*
        ConversÃ£o entre objetos e texto

        request.open('GET', requestURL);
        request.responseType = 'text'; // now we're getting a string!
        request.send();

        request.onload = function() {
            var superHeroesText = request.response; // get the string from the response
            var superHeroes = JSON.parse(superHeroesText); // convert it to an object
            populateHeader(superHeroes);
            showHeroes(superHeroes);
        }

        var myJSON = { "name": "Chris", "age": "38" };
        myJSON
        var myString = JSON.stringify(myJSON);
        myString
        */
    </script>
</body>
</html>